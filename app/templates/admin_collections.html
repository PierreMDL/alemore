{% extends "layout.html" %}

{% block titre -%}<title>Administration - Collections</title>{%- endblock titre %}

{% block contenu -%}
<div class="w3-col l2">
  <div class="w3-margin w3-padding-small w3-card-4 w3-black w3-opacity-max">
    <form action="{{ url_for('admin_collections') }}" method="POST">
      <h4 style="overflow:hidden; text-overflow:clip;">
        <b>Titre de la collection</b>
      </h4>
      <input id="titre" type="text" name="titre">
      <h4 style="overflow:hidden; text-overflow:clip;">
        <b>Description de la collection</b>
      </h4>
      <textarea id="description" name="description" style="white-space: pre-wrap;"></textarea>
      <input id="id_collection" type="hidden" name="id_collection" value="">
      <br>
      <input type="submit" value="Mettre à jour">
    </form>
  </div>
</div>
<div class="w3-col l8 m12 s12">
  {%- for étiquette in étiquettes %}
  <div class="w3-quarter w3-mobile" style="min-width:210px;">
    <div class="w3-display-container" style="width:200px; height:200px; margin:10px">
      <img class="w3-card-4" src="{{ étiquette.src }}" alt="{{ étiquette.titre.strip() }}"
           style="object-fit:cover; width:200px; height:200px" onclick="updateForm(this);">
      <div class="w3-display-hover w3-center w3-small w3-padding-small w3-opacity-min w3-gray w3-display-bottommiddle"
           style="width:100%">
        <b class="titre">{{ étiquette.titre }}</b>
        <div class="w3-hide">
        {% for paragraphe in étiquette.description -%}
          <p class="w3-small description">{{ paragraphe.strip() }}</p>
        {% endfor %}
        </div>
        <span class="w3-hide id_collection">{{ étiquette.id }}</span>
      </div>
    </div>
  </div>
  {%- endfor %}
</div>
<script>
  function updateForm(truc) {
    document.getElementById("id_collection").value = truc.parentElement.getElementsByClassName("id_collection")[0].innerHTML;
    document.getElementById("titre").value = truc.parentElement.getElementsByClassName("titre")[0].innerHTML;

    description_list = truc.parentElement.getElementsByClassName("description");

    list = [];
    for (x of description_list) {
      list = list.concat(x.innerText);
    };
    new_list = list.join("\n");

    document.getElementById("description").value = new_list;

  }
</script>
{% endblock contenu %}